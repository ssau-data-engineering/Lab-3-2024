В этой лабораторной работе рассматривалась задача кредитного скоринга с целью выбора наиболее эффективной модели. 
Были протестированы следующие модели: 
- `Extra Tree`;
- `Gradient Boosting`;
- `ADA Boosting`;
- `Hist Gradient Boosting`;
- `Random Forest`

### Пайплайн для обучения классификатора:
1. **Мониторинг новых `YAML` файлов**: используется `FileSensor`, который отслеживает появление новых конфигурационных файлов.
2. **Обучение классификатора**:
   - Используется `PythonOperator` для выполнения функций.
   - Функция `prepare_data` выполняет предобработку данных из `CSV`-файла, включая преобразование категориальных признаков,
     и разделяет их на тренировочные и тестовые выборки.
   - Функция `setup_experiment` обрабатывает эксперименты в `MLflow`.
   - Функция `train_model_function` считывает параметры из `YAML`-файлов (включая название классификатора и гиперпараметры),
     логирует параметры, обучает модель и сохраняет её в `MLflow`. Метрика для оценки — `F1-score` для обучающей и тестовой выборок.

3. **Получившиеся изображения**

- Запуски pipeline
![Запуск пайплайна](,/images/image1.jpg)

- Эксперименты и получившиеся результаты метрик 
![Experiments](,/images/image2.jpg)

### Пайплайн для хостинга лучшей модели:
1. **Определение метрики**: целевая метрика — `test_f1`, минимальный порог для выбора модели — `0.4`.
2. **Функции для поиска лучшей модели**:
   - `get_registered_models` возвращает список всех моделей.
   - `get_model_metrics` извлекает метрики для конкретной версии модели.
   - `find_best_model` находит лучшую модель среди зарегистрированных, проверяя её метрику и стадию (`None` или `Staging`). 
3. **Продвижение модели в Production**:
   - Функция `promote_to_production` переводит выбранную модель на стадию `Production`.
   - `validate_and_promote_best_model` выбирает лучшую модель и переводит её в `Production`, если она соответствует требованиям. 

4. **Лучшая модель:**
 
![BestModel](,/images/image3.jpg)
